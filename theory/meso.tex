% !TEX root = ../thesis.tex

%=========================================================
\section{Mesoscopic Description}
\label{sec:meso}
%=========================================================

    Summarize this section here.

    %=========================================================
    \subsection{Bogoliubov--de~Gennes Formalism}
    \label{subsec:meso:bdg}
    %=========================================================

    To describe superconductivity in mesoscopic and spatially inhomogeneous structures, we employ the Bogoliubov--de~Gennes (BdG) formalism, i.e. the real-space mean-field formulation of BCS theory. Starting from the BCS pairing Hamiltonian \cite{bardeen_microscopic_1957} and applying the canonical Bogoliubov transformation \cite{bogoljubov_new_1958} in the electron--hole (Nambu) representation \cite{nambu_quasi-particles_1960}, one obtains a quadratic quasiparticle Hamiltonian and an effective eigenvalue problem for the two-component Nambu spinor, as presented systematically by de~Gennes \cite{de_gennes_superconductivity_1966}. 
    
    The BdG framework provides a microscopic description of electron--hole conversion at normal--superconductor interfaces (Andreev reflection) \cite{andreev_thermal_1964} and underlies scattering approaches to transport in hybrid junctions, including the BTK model and its extensions \cite{blonder_transition_1982,beenakker_quantum_1992}.

    
        %=========================================================
        \subsubsection*{Single Particle Hamiltonian}
        %=========================================================

            To establish notation, we start from the normal-state single-particle description in the grand-canonical ensemble, where energies are measured relative to the chemical potential. The corresponding Hamiltonian reads
            \begin{equation}
                \hat{H}_\mathrm{N}(\vec{r}) = -\frac{\hbar^2}{2m}\nabla^2 + U(\vec{r}) - \mu\,,
                \label{eq:meso:h-n}
            \end{equation}
            where the (possibly spatially varying) potential $U(\vec r)$ models confinement, tunnel barriers, or disorder.

            The eigenfunctions of $\hat{H}_\mathrm{N}$ define the natural mode basis of the normal conductor,
            \begin{equation}
                \hat{H}_\mathrm{N}(\vec{r})\, \Phi_k(\vec{r}) = \xi_k\, \Phi_k(\vec{r})\,,\quad
                \xi_k=\varepsilon_k-\mu\,,
                \label{eq:meso:psi-n}
            \end{equation}
            where $\xi_k$ denotes the single-particle energies measured from the chemical potential. 
            
            In a homogeneous metal ($U=0$), the eigenfunctions and eigenvalues are given by
            \begin{equation}
                \Phi_{\vec q}(\vec r) \propto e^{\ima \vec q\cdot \vec r}\,,\quad
                \varepsilon_{\vec q}=\tfrac{\hbar^2 q^2}{2m}\,.
            \end{equation}

            In this translationally invariant limit, the abstract mode label $k$ can be identified with the wave vector $\vec q$. Throughout this chapter we reserve $k$ for a generic mode index and use explicit vectors such as $\vec q$ whenever a plane-wave momentum label is meant. More generally, the label $k$ should be understood as a compact index for the normal-state eigenmodes.

        %=========================================================
        \subsubsection*{BCS Hamiltonian}
        %=========================================================

            Upon second quantization, we introduce fermionic field operators $\hat{\psi}_\sigma(\vec r)$ and $\hat{\psi}_\sigma^\dagger(\vec r)$ that annihilate/create an electron at position $\vec{r}$ with spin $\sigma$. In the normal-state eigenbasis they admit the expansion $\hat\psi_\sigma(\mathbf r)=\sum_k \Phi_k(\mathbf r)\,c_{k\sigma}$, but we will work in real space in the following.

            Superconductivity is incorporated at the mean-field level by decoupling an effective attractive interaction in the spin-singlet pairing channel. This introduces the (generally position-dependent) pair potential $\Delta(\vec r)$, which couples time-reversed states and yields the quadratic mean-field (BCS) Hamiltonian
            \begin{equation}
                \begin{aligned}
                \hat{H}_\mathrm{BCS}(\vec{r}) 
                &= \int \mathrm{d}r^3 \sum_{\sigma=\uparrow, \downarrow} \hat{\psi}_\sigma^\dagger(\vec{r})\, \hat{H}_\mathrm{N}(\vec{r})\, \hat{\psi}_\sigma(\vec{r})\\
                &+ \int \mathrm{d}r^3 \left( 
                    \Delta(\vec{r})\, \hat{\psi}_\uparrow^\dagger(\vec{r})\, \hat{\psi}_\downarrow^\dagger(\vec{r})
                    + \Delta^\ast(\vec{r})\, \hat{\psi}_\downarrow(\vec{r})\, \hat{\psi}_\uparrow(\vec{r})
                    \right)
                \end{aligned}
                \label{eq:meso:h-bcs}
            \end{equation}

            Here $\Delta$ is the complex superconducting order parameter, which in general may depend on position. In the simplest $s$-wave, spin-singlet case considered throughout this thesis, it can be written as $\Delta(\vec r) = |\Delta| \, e^{\ima\phi(\vec r)}$, as introduced in Section~\ref{sec:micro}. It represents the amplitude and phase of the Cooper-pair condensate. The mean-field decoupling generates an additional condensation term, proportional to $|\Delta|^2$ and the inverse pairing interaction. Since it does not affect the quasiparticle eigenproblem, we omit it here.

        %=========================================================
        \subsubsection*{Bogoliubov Transformation (Nambu Formalism)}
        %=========================================================
        
            The bilinear structure of Eq.~\eqref{eq:meso:h-bcs} suggests working in an electron--hole representation, where quasiparticles appear as coherent superpositions of particle and hole degrees of freedom. In the spin-singlet \textit{s}-wave case, and in the absence of spin-dependent fields, the problem separates into two equivalent $2\times 2$ blocks. We work in the reduced Nambu basis
            \begin{equation}
                \hat\Psi(\vec r) =
                \begin{psmallmatrix}
                    \hat{\psi}_{\uparrow}(\vec r) \\
                    \hat{\psi}^{\dagger}_{\downarrow}(\vec r)
                \end{psmallmatrix}\,.
                \label{eq:meso:nambu-operator}
            \end{equation}

            We now diagonalize the quadratic Hamiltonian (Eq.~\eqref{eq:meso:h-bcs}) by introducing a set of fermionic quasiparticle operators $\hat\gamma_k$ labeled by a mode index $k$. Each mode is characterized by two position-dependent $c$-number amplitudes $u_k(\vec r)$ and $v_k(\vec r)$, which encode the electron- and hole-like components of the corresponding Bogoliubov quasiparticle.

            A Bogoliubov quasiparticle mode $k$ is then created by an operator of the form
            \begin{equation}
                \hat{\gamma}_k^{\dagger} = \int \mathrm{d}^3 r\,\left(u_k(\vec r)\,\hat{\psi}^{\dagger}_{\uparrow}(\vec r) + v_k(\vec r)\,\hat{\psi}_{\downarrow}(\vec r)\right),
                \label{eq:meso:bogoliubov-operator}
            \end{equation}
            where the amplitudes $u_k(\vec r)$ and $v_k(\vec r)$ quantify the electron- and hole-like components of the quasiparticle wave function. For compactness, we collect these amplitudes into the Nambu spinor
            \begin{equation}
                \Psi_k(\vec r) =
                \begin{psmallmatrix}
                    u_k(\vec r) \\
                    v_k(\vec r)
                \end{psmallmatrix}\,.
                \label{eq:meso:nambu-spinor}
            \end{equation}

        %=========================================================
        \subsubsection*{Bogoliubov--de~Gennes Equation}
        %=========================================================

            In this reduced Nambu basis, the quadratic mean-field Hamiltonian of Eq.~\eqref{eq:meso:h-bcs} can be written as the Bogoliubov--de~Gennes (BdG) Hamiltonian,
            \begin{equation}
                \hat{H}_\mathrm{BdG}(\vec r) =
                \begin{pmatrix}
                    \hat{H}_\mathrm{N}(\vec r) & \Delta(\vec r) \\
                    \Delta^\ast(\vec r) & -\hat{H}_\mathrm{N}^\ast(\vec r)
                \end{pmatrix}
                \,,
                \label{eq:meso:h-bdg}
            \end{equation}
            whose off-diagonal pairing potential $\Delta(\vec r)$ explicitly couples electron and hole amplitudes.

            The quasiparticle modes are then obtained from the BdG eigenvalue problem
            \begin{equation}
                \hat{H}_\mathrm{BdG}(\vec r) \, \Psi_k(\vec r) = E_k\, \Psi_k(\vec r)\,.
                \label{eq:meso:BdG}
            \end{equation}
            Here the index $k$ labels the resulting quasiparticle eigenmodes, while the explicit argument $\vec r$ denotes their spatial dependence. Because the BdG Hamiltonian possesses an intrinsic particle--hole symmetry, every solution at energy $+E_k$ is accompanied by a partner at $-E_k$ (with exchanged electron and hole components). In the normal-state limit $\Delta\to 0$, Eq.~\eqref{eq:meso:BdG} reduces to the eigenproblem of $\hat{H}_\mathrm{N}$ in Eq.~\eqref{eq:meso:h-n}.

        %=========================================================
        \subsubsection*{Uniform \textit{s}-wave Superconductor}
        %=========================================================

            As a solvable reference case, consider a homogeneous bulk superconductor with constant $U$ and a uniform pair potential $\Delta=|\Delta|e^{\ima\phi}$. In this case the BdG eigenmodes can be labeled by a wave vector $\vec q$ and an electron-like or hole-like branch, and take the plane-wave form
            \begin{equation}
                \Psi_{\vec q}(\vec r) = \Psi_{0}(E_{\vec q})\, e^{\ima \vec q \cdot \vec r}\,,\qquad
                \xi_{\vec q}=\frac{\hbar^2 q^2}{2m}-\mu\,,\qquad
                E_{\vec q}=\sqrt{\xi_{\vec q}^2+|\Delta|^2}\,.
                \label{eq:meso:BdG-plane-wave}
            \end{equation}
            Here $\Psi_{0}(E_{\vec q})$ is a two-component spinor containing the electron and hole amplitudes for the quasiparticle at energy $E_{\vec q}$. Choosing a gauge where $\phi$ is constant, a convenient phase convention is
            \begin{equation}
                \Psi_{0}(E_{\vec q})\equiv
                \begin{psmallmatrix}
                    u_0(E_{\vec q}) \\
                    v_0(E_{\vec q})\,e^{\ima\phi}
                \end{psmallmatrix}\,,
            \end{equation}
            so that the condensate phase appears explicitly in the hole component.
        
            In the bulk description above, quasiparticle states are naturally labeled by the mode index (here the wave vector $\vec q$). In scattering problems, by contrast, one typically works at fixed quasiparticle energy $E$ (set by bias and the reservoir distributions) and distinguishes electron-like and hole-like branches through the sign of the normal-state energy.

            Accordingly, we reparametrize the bulk dispersion relation $E^2=\xi^2+|\Delta|^2$ in terms of
            \begin{equation}
                \xi_{\pm}(E) = \pm\sqrt{E^2-|\Delta|^2}\,.
                \label{eq:meso:xi-branches}
            \end{equation}
            For $|E|<|\Delta|$ the quantity $\xi_{\pm}(E)$ is purely imaginary, reflecting that bulk solutions are evanescent rather than propagating.

            The corresponding coherence factors of a uniform $s$-wave superconductor can then be written in their standard form,
            \begin{equation}
                \begin{aligned}
                    u_0(E) &= \sqrt{\tfrac{1}{2}\left(1+\xi_{\pm}(E)\,/\,E\right)}\,,\\
                    v_0(E) &= \sqrt{\tfrac{1}{2}\left(1-\xi_{\pm}(E)\,/\,E\right)}\,.
                \end{aligned}
                \label{eq:meso:coherence-factors}
            \end{equation}
            Here the choice of branch $\xi_{\pm}(E)$ corresponds to electron-like ($+$) or hole-like ($-$) propagation. These energy-domain expressions will be used throughout the following scattering formulations (e.g. BTK), where one works at fixed $E$ rather than fixed $\vec q$.

        The absence of propagating subgap quasiparticles in a homogeneous superconductor is the microscopic origin of Andreev conversion at an N--S interface. In particular, the spectrum $E^2=\xi^2+|\Delta|^2$ implies the familiar BCS density of states, Equation~\eqref{eq:micro:dos-bcs}, while for $|E|<|\Delta|$ one must describe transport in terms of coherent electron--hole conversion processes.
    
    %=========================================================
    \subsection{Andreev Reflection}
    \label{subsec:meso:ar}
    %=========================================================

        At a normal--superconductor (N--S) interface, quasiparticles with subgap energies $|E| < |\Delta|$ cannot enter the superconductor as propagating single-particle excitations because the BCS quasiparticle continuum starts only at $|E|=|\Delta|$. Instead, an incident electron from the normal side can be coherently converted into a reflected hole while a charge $2e$ is transferred into the superconducting condensate. This process is known as Andreev reflection and constitutes the elementary mechanism by which normal-state carriers couple to superconducting correlations \cite{andreev_thermal_1964}.

        The Andreev approximation is the quasiclassical limit of the BdG equations in which all relevant excitation energies are small compared to the Fermi energy ($|E|,\ |\Delta| \ll E_\mathrm{F}$). In this regime only states within a narrow shell around the Fermi surface contribute, and the normal-state dispersion can be linearized,
        \begin{equation}
            \xi(\vec k) \approx \hbar \vec v_\mathrm{F}\cdot(\vec k-\vec k_\mathrm{F})\,,
        \end{equation}
        so that electron-like and hole-like components of a quasiparticle have nearly equal momentum magnitudes. For an incident electron at energy $E$ the corresponding wave vectors satisfy
        \begin{equation}
            k_\mathrm{e} \simeq k_\mathrm{F} + \delta k\,,\qquad
            k_\mathrm{h} \simeq k_\mathrm{F} - \delta k\,,\qquad
            \delta k \sim E\,/\,(\hbar v_\mathrm{F})\,,
        \end{equation}
        implying that the Andreev-reflected hole approximately retraces the incoming trajectory, called retroreflection, up to corrections of order $E/E_\mathrm{F}$.

        A second important consequence is that for subgap energies $|E|<|\Delta|$ the superconductor does not support propagating bulk quasiparticles. Instead, the BdG solutions in a homogeneous superconducting region are evanescent. Subgap transport across an N--S interface is therefore necessarily mediated by coherent electron--hole conversion. 
        
        In the ''Andreev limit'' of a ideal and highly transparent contact with negligible normal reflection, this conversion occurs with approximately unit probability, so that the subgap process is fully characterized by a phase shift. The subgap Andreev reflection amplitude $r_\mathrm{A}(E)$ for an incident electron being reflected as a hole is given by
        \begin{equation}
            r_\mathrm{A}(E)=e^{-\ima\vartheta} \, e^{-\ima\phi}\,,\qquad
            \vartheta = \arccos(E/|\Delta|)\,,\qquad
            (|E|<|\Delta|)\,,
            \label{eq:meso:andreev-amplitude}
        \end{equation}
        where $\vartheta(E)$ donates the ''Andreev phase''. The condensate phase $\phi$ encode the coherence of the conversion process. For nonideal interfaces, finite backscattering reintroduces normal reflection and reduces $|r_\mathrm{A}(E)|<1$ below unity.

        Importantly, the Andreev approximation introduced above is an energy-scale approximation and is conceptually distinct from assumptions about interface transparency. The latter determine the relative weight of normal and Andreev reflection and are treated quantitatively by scattering approaches such as the BTK model.    
        
        Andreev reflection provides the dominant subgap transport mechanism in N--S junctions and serves as the microscopic building block for superconducting transport in mesoscopic weak links. In a two-terminal S--N--S geometry, successive Andreev conversions at both interfaces lead to discrete Andreev bound states in equilibrium and to multiple Andreev reflection under finite bias. The following sections build directly on this Andreev-based picture, developing ABS and MAR from the same underlying mechanism.

        More generally, and in particular for atomic-scale contacts, the same physics is most naturally formulated in terms of scattering channels characterized by their normal-state transmissions $\{\tau_i\}$. To make this qualitative picture quantitative and to compute the corresponding \textit{I--V} characteristics across the full transparency range, we now turn to the Blonder--Tinkham--Klapwijk (BTK) model \cite{blonder_transition_1982,beenakker_quantum_1992}.

        %=========================================================
        \subsubsection*{Blonder--Tinkham--Klapwijk Model}
        %=========================================================

            Building on the qualitative picture of Andreev reflection introduced above, the Blonder--Tinkham--Klapwijk (BTK) model provides a quantitative scattering description of an N--S interface with arbitrary transparency $\tau$. It yields the energy-resolved  probabilities for Andreev reflection ($A$), normal reflection ($B$), and transmission into the superconductor ($C$). To incorporate finite quasiparticle lifetimes, we use the phenomenological broadening introduced by PlecenÃ­k \textit{et al.}, replacing the quasiparticle energy by $E \rightarrow |E| + \ima\gamma$ \cite{plecenik_finite-quasiparticle-lifetime_1994}. 

            Using the normalization factor $d$, the Andreev and normal reflection amplitudes ($a$, $b$) acquire the compact form,
            \begin{equation}
                \begin{aligned}
                    A(E) &= aa^*\,,\quad
                    a= u_0v_0/d\,,\quad
                    d = \left(u^2_0-(1-\tau)v_0^2\right)/\tau\,,\\
                    B(E) &= bb^*\,,\quad
                    b= -(u_0^2-v_0^2)\left( (1-\tau) + \ima \sqrt{\tau(1-\tau)} \right)\,/\,d\,,
                \end{aligned}
                \label{eq:meso:btk-parameter}
            \end{equation}
            with $u_0$ and $v_0$ as coherence factors, given by Eq.~\eqref{eq:meso:coherence-factors}

            For subgap energies, transmission into the quasi-particle continuum vanishes ($C\to0$), so $A(E) + B(E) = 1$. It is therefore convenient to define the energy-resolved spectral weights $\rho$ of the single-particle (1e) and two-particle (2e) processes,
            \begin{equation}
                \begin{aligned}
                    \rho_\mathrm{1e}(E) &= 1 - A(E) - B(E)\,,\\
                    \rho_\mathrm{2e}(E) &= 2 \, A(E) \,,
                \end{aligned}
                \label{eq:meso:btk-dos}
            \end{equation}
            which quantify the relative importance of normal and Andreev processes. For finite lifetime broadening ($\gamma>0$) this strict relation is relaxed and the effective single-particle weight $\rho_{\mathrm{1e}}$ acquires finite subgap contributions. Although these functions resemble densities of states, they should not be interpreted as the physical BCS DOS. Instead, they represent the BTK spectral kernels entering the current integral (Eq.~\ref{eq:meso:btk-iv}). 

            The current through an N--S junction then follows from the BTK kernel,
            \begin{equation}
                \begin{aligned}
                    I_\mathrm{1e}(V) &= \frac{G_0}{e} \int_{-\infty}^{\infty} \rho_\mathrm{1e}(E) \left(f(E) - f(E + eV)\right) \mathrm{d}E\,,\\
                    I_\mathrm{2e}(V) &= \frac{G_0}{e} \int_{-\infty}^{\infty} \rho_\mathrm{2e}(E) \left(f(E) - f(E + eV)\right) \mathrm{d}E\,,\\
                    I_\mathrm{NS}(V) &= I_\mathrm{1e}(V) + I_\mathrm{2e}(V)\,.
                \end{aligned}
                \label{eq:meso:btk-iv}
            \end{equation}
            Increasing the transparency enhances the weight of Andreev processes, leading to a pronounced subgap conductance and a gradual reduction of the coherence-peak height. In the tunneling limit ($\tau \ll 1$), Eq.~\eqref{eq:meso:btk-iv} reduces to the conventional quasiparticle-tunneling expression, while for $\tau \approx 1$ the transport approaches the Andreev limit, where charge is transferred predominantly in units of $2e$.

            \begin{figure}[t]
                \centering
                \subfigure[Spectral weight of single-particle process]{\import{theory/meso}{btk-1e-dos.pgf}}
                \hfill
                \subfigure[Spectral weight of two-particle process]{\import{theory/meso}{btk-2e-dos.pgf}}
                \subfigure[\textit{I--V} characteristic]{\import{theory/meso}{btk-iv.pgf}}
                \hfill
                \subfigure[\textit{dI--dV} characteristics]{\import{theory/meso}{btk-didv.pgf}}
                \caption{
                    BTK spectral weights of the single-particle (1e) and two-particle (2e) channels and the corresponding \textit{I--V} and \textit{dI--dV} characteristics for various channel transparencies $\tau$. Increasing $\tau$ shifts spectral weight from normal to Andreev processes, leading to enhanced subgap conductance and reduced coherence-peak height. Parameters correspond to aluminum (Sec.~\ref{subsec:basics:aluminum}), with $T=0$ and $\gamma = 0$.
                    }
                \label{fig:meso:btk}
            \end{figure}

            Figure~\ref{fig:meso:btk} summarizes the BTK description of an N--S interface across the full transparency range. Panels (a) and (b) show the energy-resolved spectral weights $\rho_{\mathrm{1e}}(E)$ and $\rho_{\mathrm{2e}}(E)$ (Eq.~\eqref{eq:meso:btk-dos}), which enter the current integral in Eq.~\eqref{eq:meso:btk-iv}. In the tunneling regime ($\tau\ll 1$), the response is dominated by the single-particle channel and exhibits pronounced coherence peaks at $|E|\approx\Delta$. With increasing transparency, spectral weight is transferred to the Andreev channel, yielding enhanced subgap conductance and a reduced peak height, as reflected in the corresponding $I$--$V$ and $\mathrm{d}I/\mathrm{d}V$ curves in panels (c) and (d).

    %=========================================================
    \subsection{Andreev Bound States}
    \label{subsec:meso:abs}
    %=========================================================
    
        Andreev reflection becomes phase-coherent and spectrally quantized when two superconductors are connected by a mesoscopic weak link. In an S--N--S geometry, a subgap quasiparticle ($|E|<|\Delta|$) cannot escape into the superconducting continua and instead undergoes successive Andreev conversions at both interfaces, alternating between electron- and hole-like character while acquiring the superconducting phase difference $\varphi=\phi_\mathrm{R}-\phi_\mathrm{L}$. The resulting constructive-interference condition quantizes the motion into discrete subgap eigenstates localized around the junction, known as Andreev bound states (ABS) \cite{andreev_thermal_1964,kulik_effect_1969,ishii_josephson_1970}. These ABS form the microscopic origin of the dc Josephson effect in short and mesoscopic junctions: their phase-dependent energies $E_n(\varphi)$ determine the equilibrium supercurrent via their occupation \cite{beenakker_josephson_1991, beenakker_quantum_1992}.

        \subsubsection*{ABS Spectra}
        \subsubsection*{CPR}
        \subsubsection*{ballistic limit}
        \subsubsection*{arbitrary transmission}
        \subsubsection*{Fractional Shapiro Steps}
